# Build configuration for single-platform hosting
# This serves both React frontend and Django backend from one service

build:
  # For platforms that support monorepo detection
  commands:
    # Build React frontend
    - cd frontend && npm install && npm run build
    # Install Python dependencies  
    - cd backend && pip install -r requirements.txt
    # Collect Django static files
    - cd backend && python manage.py collectstatic --noinput

start:
  # Start command varies by platform:
  
  # For Railway/Render:
  command: "cd backend && python manage.py runserver 0.0.0.0:$PORT"
  
  # For DigitalOcean (if using unified approach):
  # Uses the Dockerfile.unified automatically

web:
  # Most platforms will serve frontend from backend's static files
  # Django will serve the React build files at the root URL
  
env:
  # Required environment variables
  DEBUG: "False"
  SECRET_KEY: "your-secret-key-here"
  ALLOWED_HOSTS: "yourdomain.com,*.railway.app,*.render.com,*.ondigitalocean.app"
  CORS_ALLOWED_ORIGINS: "https://yourdomain.com"
  REACT_APP_API_URL: "/api"  # Relative URL since same domain
